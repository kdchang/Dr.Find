"use strict";angular.module("drfindApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap","ui.select2","firebase","angular-loading-bar","ngMap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/visualize",{templateUrl:"views/visualize.html",controller:"VisualizeCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("drfindApp").controller("MainCtrl",["$scope","$firebase","$q","$http",function(a,b,c,d){var e=function(a){console.log(a.coords.latitude),console.log(a.coords.longitude)};navigator.geolocation&&navigator.geolocation.getCurrentPosition(e);var f=new Firebase("https://drfind.firebaseio.com/L");a.makers=b(f),a.stores=[{name:"store 1"},{name:"store 2"},{name:"store 3"}],a.fakeMap=[{id:"12348",name:"宏國牙醫診所",coords:[25.058856,121.554862],address:"台北市民生東路五段15號",phone:"02-27601715",click:"callDoc",link:"https://clinic.firebaseio.com/clinic/3701010061.json"},{id:"12348",name:"元榜牙醫診所",coords:[25.058258,121.553322],address:"台北市松山區民生東路四段119號",phone:"02-27162512",click:"callDoc",link:"https://clinic.firebaseio.com/clinic/0101090019.json"}],a.map={center:{latitude:25.058856,longitude:121.554862},zoom:15},a.callDetailInfo=function(b,d){console.log("XDDDDD"),console.log(d);var e=c.defer(),f=e.promise;f.then(function(b){a.info=b}),$.getJSON(d,function(){}).done(function(a){console.log(a),e.resolve(a)}).fail(function(){console.log("error")}).always(function(){console.log("complete")}).complete(function(){console.log("second complete")})},a.token="",a.getToken=function(){var b=a.q=c.defer(),e=a.q.promise,f=$.param({id:"d93f4a40f62804f081c3c53a22a1c4d3",secret_key:"518ccaebd250af3e223739b216c4cac8"}),g=d({method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:"http://api.ser.ideas.iii.org.tw/api/user/get_token",data:f});g.success(function(a){b.resolve(a.result.token)}),e.then(function(b){console.log(b),a.token=b,a.keywordSearch("糖尿病","http://api.ser.ideas.iii.org.tw:80/api/keyword_search/forum/title"),a.keywordSearch("糖尿病","http://api.ser.ideas.iii.org.tw:80/api/keyword_search/news/title"),a.keywordSearch("糖尿病","http://api.ser.ideas.iii.org.tw:80/api/keyword_search/ptt/title")})},a.keywordSearch=function(b,e){var f=a.q=c.defer(),g=a.q.promise,h=$.param({token:a.token,keyword:b}),i=d({method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:e,data:h});i.success(function(a){f.resolve(a)}),g.then(function(a){console.log(a)})},a.getToken()}]),angular.module("drfindApp").controller("VisualizeCtrl",["$scope",function(a){a.map={center:{latitude:25,longitude:121},zoom:10}}]),angular.module("drfindApp").controller("AboutCtrl",["$scope",function(){}]),angular.module("drfindApp").controller("NavCtrl",["$scope","$location",function(a,b){a.getNavClass=function(a){return a===b.path()?"active":""}}]);